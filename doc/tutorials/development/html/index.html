<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>DiVinE: DiVinE Development Standards</title>
<link href="styles.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>DiVinE Development Standards</h1>
<p>
<h3 align="center">0.8.0 </h3><h2><a class="anchor" name="devel_intro">
Introduction</a></h2>
This tutorial contains standards, advices and methods of development of DiVinE<h2><a class="anchor" name="devel_cvs">
CVS</a></h2>
<h3><a class="anchor" name="devel_cvs_usage">
Usage</a></h3>
CVS is a system for team project development. It is able to keep a track of all versions of all source files in a project. For using our CVS, set following environmental variables: <div class="fragment"><pre class="fragment">CVSROOT=<span class="stringliteral">"$USER@anna.fi.muni.cz:/mnt/sda1/CVSroot"</span>
CVS_RSH=ssh
</pre></div><p>
Then get the complete CVS tree of DiVinE using <code>cvs checkout divine</code> in directory, where you want to have it placed.<p>
Basic usage of CVS: <ul>
<li>
<code>cvs update -dPA</code> ... updates recursivly the current directory of CVS (-d = add new directories, -P = delete empty directories, -A = do not care of any tags, take really latest version).<br>
 All files are added (letter U), changed accodring to latest changes in CVS (letter P), merged local and latest CVS changes without problems (letter M and warning about merging) or merged with conflicts (letter C). In case of conflicts it is necessary to edit the file to merge conflicting parts (highlighed with &gt;&gt;&gt;&gt;&gt;&gt;&gt;) manually. Files having letter M by their left side during update are locally modified files not checked in CVS.  </li>
<li>
<code>cvs add [file1] [file2] ...</code> ... adds files or directories to CVS </li>
<li>
<code>cvs commit [file1] [file2] ...</code> ... checks files in CVS (copies changes in local copies of files to CVS). Comment for change is needed.  </li>
</ul>
<p>
<b>Remember:</b> It is always better to do <code>cvs update -dPA</code> before <code>cvs commit</code><p>
For more informations see <code>info cvs</code>, <code>man cvs</code> or one of many <a href="http://www.csc.calpoly.edu/~dbutler/tutorials/winter96/cvs/">tutorials on usage of CVS</a>.<h3><a class="anchor" name="devel_cvs_structure">
Structure of CVS</a></h3>
Our CVS has a fixed structure, which should not be broken even through many people have rights to do it. Please contact project leaders before adding of new directories, if you are unsure where to put them.<p>
<ul>
<li>
<b>bin</b> - directory where executables are placed after compilation (both binary and scripts) - it should be initially empty </li>
<li>
<b>doc</b> - documentation: <ul>
<li>
<b>web</b> - sources of DiVinE's web: <ul>
<li>
<b>content</b> - XML files containing the content of web pages </li>
<li>
<b>layout</b> - XSL stylesheets converting XML to the final HTML form  </li>
</ul>
</li>
<li>
<b>tutorials</b> - documentation describing various topics in DiVinE containing detailed descriptions, explanations, advices and methods.  </li>
<li>
<b>refs</b> - reference manuals for various parts of DiVinE. The most important is probably reference manual for DiVinE Library. These reference manuals are generated from source codes  </li>
</ul>
</li>
<li>
<b>dwi</b> - sources of DiVinE Web Interface </li>
<li>
<b>examples</b> - sources of example models and LTL properties possible to verify by DiVinE Tool Set </li>
<li>
<b>lib</b> - directory containg Makefile for compilation of DiVinE Library. Binaries of library are placed here </li>
<li>
<b>src</b> - directory contating source codes od DiVinE Library. Directly in this directory there are placed header files of library. <ul>
<li>
<b>common</b> - units containg classes and functions commonly used by other parts of DiVinE Library. It mostly contains technical stuff (making implementation easier or more effective) </li>
<li>
<b>distributed</b> - classes regarding distributed computing </li>
<li>
<b>por</b> - classes for partial order reduction of state space </li>
<li>
<b>storage</b> - classes implementing management of storing of states  </li>
<li>
<b>syntax_analysis</b> - classes, functions and LALR grammar for reading in of DVE sources </li>
<li>
<b>system</b> - classes implementing the representation of running system </li>
</ul>
</li>
<li>
<b>support</b> - tools and settings for developers of DiVinE <ul>
<li>
<b>etc</b> - settings of utilities used only by developers (e. g. Doxygen) </li>
<li>
<b>src</b> - sources of supporting utils <ul>
<li>
<b>debug</b> - scripts for easier debugging </li>
<li>
<b>local</b> - scripts strongly dependent on the machine, where web pages and CVS of DiVinE are placed. They enable publishing of releases, documentation etc. </li>
<li>
<b>makeutils</b> - scripts for creation of templates of Makefile.am files and auxiliary scripts and macros for Autoconf/Automake  </li>
<li>
<b>regression_tests</b> - tests of various parts of DiVinE. They should protect DiVinE from being published broken.  </li>
</ul>
</li>
</ul>
</li>
<li>
<b>tool</b> - sources of tools built on DiVinE Library. Every single model checking algorithm or more complex utility should have its own directory. Directories containing more than 1 utility are: <ul>
<li>
<b>model_manipulation</b> - contain utilities processing sources of models </li>
<li>
<b>utils</b> - unsorted utilities </li>
</ul>
<p>
</li>
</ul>
<h2><a class="anchor" name="devel_compilation">
Compilation of Sources</a></h2>
DiVinE uses compilation system based on <a href="http://sources.redhat.com/automake/automake.html">Automake</a>/<a href="http://www.gnu.org/software/autoconf/manual/autoconf.pdf">Autoconf</a>. In this section, the configuration of these tools for DiVinE is described and explained.<h3><a class="anchor" name="devel_compilation_beginning">
Beginning</a></h3>
If you have a copy of CVS repository (either using <code>cvs checkout</code> or <code>cvs copy</code>, you can compile it from a scratch using this sequence of commands:<p>
<div class="fragment"><pre class="fragment">./autogen
./configure
make
</pre></div><p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Script <code>configure</code> creates Makefiles from their Automake/Autoconf templates. It tries to detect configuration of system, paths to various programs needed for compilation etc. It has many useful command line arguments. Some of them are DiVinE-specific - namely: <div class="fragment"><pre class="fragment">--enable-checks
--enable-debug
--enable-non-cvs-compilation-flags
--disable-gui
</pre></div> <b>Important</b>: Defaultly sources are compiled without any optimization. To turn the optimization on, just run <code>configure</code> with argument <code>--enable-non-cvs-compilation-flags</code></dd></dl>
See <code>./configure --help</code> for the detailed description.<h3><a class="anchor" name="devel_compilation_basic_conf_files">
Basic Configuration Files</a></h3>
<ul>
<li>
<code>configure.ac</code> ... Main configuration file of Autoconf, it is also read by Automake to find out Makefiles to create </li>
<li>
<code>aclocal.m4</code> ... created by <code>aclocal</code> utility of Automake (using configure.ac) - contains macros supplied by Automake to extend macro set of Autoconf (in fact it is a little hack of Automake developers needing better functionality of Autoconf) </li>
<li>
<code>acinclude.m4</code> ... all included M4 macros (for Autoconf purposes) from directory <code>support/src/makeutils/</code> </li>
<li>
<code>Makefile.am</code> ... local configuration files for Automake. Needed everywhere you want to create Makefile. First, it is translated to <code>Makefile.in</code> by Automake and then <code>Makefile</code> is created by script <code>configure</code> (created by Autoconf) </li>
<li>
<code>Makefile.am.global</code> ... in DiVinE this file is included into every Makefile.am. It contains common definitions of variablesi (prefix of executables, flags for C++ compilation, paths to common data files, etc.) </li>
</ul>
<h3><a class="anchor" name="devel_compilation_special">
Special Cases of Compilation</a></h3>
In this section some special cases of compilation, which are not fully integrated into Autoconf/Automake compilation system, are covered.<h4><a class="anchor" name="devel_compilation_special_syntax">
Translation of Syntax Analyzer</a></h4>
Directory <code>src/system/dve/syntax_analysis</code> contains files <code>dve_grammar.yy</code>, <code>dve_lexer.l</code> and <code>dve_keywords.gperf</code>. They have to be translated into corresponding C/C++ sources. It is not made using Autoconf/Automake, because a local Makefile is easier to create in this case and the translation to C/C++ is needed very rarely. Resulting C/C++ sources are stored in CVS and they are also a part of the distribution package.<p>
Sources are translated using <code>divine/src/system/dve/syntax_analysis/Makefile</code>. This Makefile translates: <ul>
<li>
<code>dve_lexer.l</code> to <code>dve_lexer.cc</code> </li>
<li>
<code>dve_keywords.gperf</code> to <code>dve_keywords.cc</code> </li>
<li>
<code>dve_grammar.yy</code> to <code>dve_grammar.cc</code>, <code>dve_expr_grammar.cc</code>, <code>dve_trans_grammar.cc</code> and <code>dve_proc_grammar.cc</code> ... LALR(1) syntax analyzers for systems, expressions, transitions and processes. Different outputs are caused by special substitutions applied to <code>dve_grammar.yy</code>. </li>
</ul>
<h4><a class="anchor" name="devel_compilation_special_nips_compiler">
Compilation of pml2s.jar</a></h4>
In next paragraphs <em>JAR</em> denotes directory <code>tool/model_manipulation/jar</code> and <em>SOURCES</em> stands for <code>tool/model_manipulation/nips_compiler</code>.<p>
Directory <em>JAR</em> contains file <code>pml2s.jar</code>, which is compiled from Java sources in <em>SOURCES</em><code>/src</code>. A Makefile used for compilation arises from <code>Makefile.am</code> in <em>JAR</em>.<p>
File <code>pml2s.jar</code> is stored in CVS and its recompilation is needed, if Java sources in directory <em>SOURCES</em> change. The change of Java sources is not detected by the Makefile - recompilation has to be invoked manually by execution of <code>make</code> in directory <em>JAR</em>.<p>
The Makefile changes the current directory to <em>SOURCES</em> and uses a Makefile in it to compile all Java sources. Then it builds <code>pml2s.jar</code> file using <code>jar</code> <code>c</code>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>In order to compile Java sources, libraries from <em>JAR</em> are always temporarily copied to temporary directory <em>SOURCES</em><code>/lib</code>. They are deleted from there, if compilation finishes successfully. </dd></dl>
</div>
<hr size="1"><small><img align="center" src="divine_mini.gif"><b>Tutorial, 2006 developed in <a href="http://www.fi.muni.cz/paradise/">ParaDiSe</a> laboratory, <a href="http://www.fi.muni.cz/">Faculty of Informatics</a>, <a href="http://www.muni.cz/">Masaryk University</a></b></small>
</body>
</html>



