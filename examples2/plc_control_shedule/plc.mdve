default(MAXTIME,500) dnl

const byte cempty=2, undef1=0, undef2=1,
	  sol42C=3, sol42H=4, sol84C=5, sol84H=6,
	  sol70C=7, sol140C=8,
	  water28C=9, water28H=10, water56C=11, water56H=12;

const int maxtime=MAXTIME, maxstep=120;

byte 	v8=0, v9=0, v11=0, v12=0, v13=0, v15=0, v17=0, v29=0;
byte	cycle=0;
byte	mix=0, heat=0;
byte	p1=0, p2=0;
byte	px[14] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; 
/* the last one can be 1 */
byte	B1=sol42C, B2=water28C, B3=cempty, B4=cempty, B5=cempty, 
	B6=cempty, B7=cempty;

int 	time=0, tB1B3=0, tB2B3=0, tB3B4=0, tB4B5=0, tB5B7=0;
int 	tH=0, tC6=0, tC7=0, tP1=0, tP2=0;
byte 	batches=0;
byte 	error=0;
byte 	atomic=0;

define(phi,	`((($1==1) && ($2==1) && (B1==sol42C) && (B3==cempty))
		||(($1==1) && ($2==2) && (B1==sol84C) && (B3==cempty))
		||(($1==2) && ($2==1) && (B2==water28C) && (B3==cempty))
		||(($1==2) && ($2==2) && (B2==water56C) && (B3==cempty))
		||(($1==3) && ($2==1) && (B1==sol42C) && (B3==water28C))
		||(($1==3) && ($2==2) && (B1==sol84C) && (B3==water28C))
		||(($1==4) && ($2==1) && (B2==water28C) && (B3==sol42C))
		||(($1==4) && ($2==2) && (B2==water56C) && (B3==sol42C))
		||(($1==5) && ($2==1) && (B3==sol70C) && (B4==cempty))
		||(($1==5) && ($2==2) && (B3==sol70C) && (B4==sol70C))
		||(($1==6) && ($2==1) && (B4==sol70C) && (B5==cempty))
		||(($1==6) && ($2==2) && (B4==sol140C) && (B5==cempty))
		||(($1==7) && ($2==1) && (B5==sol70C) && (B6==cempty))
		||(($1==7) && ($2==2) && (B5==sol70C) && 
			((B6==water28C) || (B6==water28H)))
		||(($1==8) && ($2==1) && (B5==sol42H) && (B7==cempty))
		||(($1==8) && ($2==2) && (B5==sol42H) && 
			((B7==sol42C) || (B7==sol42H)))
		||(($1==9) && ($2==1) && (B7==sol42H))
		||(($1==9) && ($2==2) && (B7==sol84H))
		||(($1==10) && ($2==1) && (B6==water28H))
		||(($1==10) && ($2==2) && (B6==water56H))
		||(($1==11) && ($2==1) && (B7==sol42C) && (B1==cempty))
		||(($1==11) && ($2==2) && (B7==sol84C) && (B1==cempty))
		||(($1==12) && ($2==1) && (B7==sol42C) && (B1==sol42C))
		||(($1==12) && ($2==2) && (B7==sol84C) && (B1==sol42C))
		||(($1==13) && ($2==1) && (B6==water28C) && (B2==cempty))
		||(($1==13) && ($2==2) && (B6==water56C) && (B2==cempty))
		||(($1==14) && ($2==1) && (B6==water28C) && (B2==water28C))
		||(($1==14) && ($2==2) && (B6==water56C) && (B2==water28C)))')


define(conpsi,
	`((($1==1) && (px[2]==0) && (px[4]==0) && (px[5]==0) && (px[11]==0))
	||(($1==2) && (px[1]==0) && (px[3]==0) && (px[5]==0) && (px[12]==0))
	||(($1==3) && (px[2]==0) && (px[4]==0) && (px[5]==0) && (px[11]==0))
	||(($1==4) && (px[1]==0) && (px[3]==0) && (px[5]==0) && (px[12]==0))
	||(($1==5) && (px[1]==0) && (px[2]==0) && (px[3]==0) && (px[4]==0) 
		&& (px[6]==0))
	||(($1==6) && (px[5]==0) && (px[7]==0) && (px[8]==0))
	||(($1==7) && (px[6]==0) && (px[8]==0) && (px[10]==0) && (px[12]==0))
	||(($1==8) && (px[6]==0) && (px[7]==0) && (px[9]==0) && (px[11]==0))
	||(($1==9) && (px[8]==0) && (px[11]==0))
	||(($1==10) && (px[7]==0) && (px[12]==0))
	||(($1==11) && (px[1]==0) && (px[3]==0) && (px[8]==0) && (px[9]==0))
	||(($1==12) && (px[1]==0) && (px[3]==0) && (px[8]==0) && (px[9]==0))
	||(($1==13) && (px[2]==0) && (px[4]==0) && (px[7]==0) && (px[10]==0))
	||(($1==14) && (px[2]==0) && (px[4]==0) && (px[7]==0) && (px[10]==0)))')

define(ppsi, `((phi($1,$2)) && ((conpsi($1))))')

define(psi, `((ppsi($1,1)) || (ppsi($1,2)))')

define(contheta,
	`(((($1==1) || ($1==3)) && (not(psi(5))))
	||((($1==2) || ($1==4)) && (not(psi(1))) && (not(psi(3))) && 
		(not(psi(5))))
	||(($1==5) && (not(psi(6))))
	||(($1==6) && (not(psi(7))) && (not(psi(8))))
	||($1==7)
	||(($1==8) && (not(psi(7))))
	||(($1==9) && (not(psi(8))))
	||(($1==10) && (not(psi(7))))
	||((($1==11) || ($1==12)) && (not(psi(1))) && (not(psi(3))) && 
		(not(psi(8))) && (not(psi(9))))
	||((($1==13) || ($1==14)) && (not(psi(2))) && (not(psi(4))) && 
		(not(psi(7))) && (not(psi(10)))))')

define(theta, `((ppsi($1,$2)) && (contheta($1)))')

define(result, `((($1==1) && ($2==1) && (B1==cempty) && (B3==sol42C))
		||(($1==1) && ($2==2) && (B1==sol42C) && (B3==sol42C))
		||(($1==2) && ($2==1) && (B2==cempty) && (B3==water28C))
		||(($1==2) && ($2==2) && (B2==water28C) && (B3==water28C))
		||(($1==3) && ($2==1) && (B1==cempty) && (B3==sol70C))
		||(($1==3) && ($2==2) && (B1==sol42C) && (B3==sol70C))
		||(($1==4) && ($2==1) && (B2==cempty) && (B3==sol70C))
		||(($1==4) && ($2==2) && (B2==water28C) && (B3==sol70C))
		||(($1==5) && ($2==1) && (B3==cempty) && (B4==sol70C))
		||(($1==5) && ($2==2) && (B3==cempty) && (B4==sol140C))
		||(($1==6) && ($2==1) && (B4==cempty) && (B5==sol70C))
		||(($1==6) && ($2==2) && (B4==sol70C) && (B5==sol70C))
		||(($1==7) && ($2==1) && (B5==sol42H) && (B6==water28H))
		||(($1==7) && ($2==2) && (B5==sol42H) && (B6==water56H))
		||(($1==8) && ($2==1) && (B5==cempty) && (B7==sol42H))
		||(($1==8) && ($2==2) && (B5==cempty) && (B7==sol84H))
		||(($1==9) && ($2==1) && (B7==sol42C))
		||(($1==9) && ($2==2) && (B7==sol84C))
		||(($1==10) && ($2==1) && (B6==water28C))
		||(($1==10) && ($2==2) && (B6==water56C))
		||(($1==11) && ($2==1) && (B7==cempty) && (B1==sol42C))
		||(($1==11) && ($2==2) && (B7==sol42C) && (B1==sol42C))
		||(($1==12) && ($2==1) && (B7==cempty) && (B1==sol84C))
		||(($1==12) && ($2==2) && (B7==sol42C) && (B1==sol84C))
		||(($1==13) && ($2==1) && (B6==cempty) && (B2==water28C))
		||(($1==13) && ($2==2) && (B6==water28C) && (B2==water28C))
		||(($1==14) && ($2==1) && (B6==cempty) && (B2==water56C))
		||(($1==14) && ($2==2) && (B6==water28C) && (B2==water56C)))')


/* initstate defines 1 batches */

process B1toB3 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B1!=cempty) && (v8==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B1==sol42C); effect B1=undef1; },
 one1 -> one2 { guard (B1==sol84C); effect B1=undef2; },
 one2 -> one3 { guard (B3==cempty); effect B3=undef1; },
 one2 -> one3 { guard ((B3==water28C) && (mix==1)); effect B3=undef2; },
 one2 -> one2 { guard ((B3!=cempty) && ((B3!=water28C) || (not(mix==1)))); 
	effect error=1; },
 one3 -> initstate2 { effect tB1B3=time+32, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tB1B3) && (cycle==0) && (v8==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B1==undef1); effect B1=cempty; },
 two1 -> two2 { guard (B1==undef2); effect B1=sol42C; },
/* two1 -> two2 { }, nema byt */
 two2 -> two3 { guard (B3==undef1); effect B3=sol42C; },
 two2 -> two3 { guard ((B3==undef2) && (mix==1)); effect B3=sol70C; },
 two2 -> two2 { guard ((B3!=undef1) && ((B3!=undef2) || (not(mix==1)))); 
	effect error=2; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process B2toB3 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B2!=cempty) && (v9==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { },
 one1 -> one2 { guard (B2==water28C); effect B2=undef1; },
 one1 -> one2 { guard (B2==water56C); effect B2=undef2; },
 one2 -> one3 { guard (B3==cempty); effect B3=undef1; },
 one2 -> one3 { guard ((B3==sol42C) && (mix==1)); effect B3=undef2; },
 one2 -> one2 { guard ((B3!=cempty) && ((B3!=sol42C) || (not(mix==1)))); 
	effect error=3; },
 one3 -> initstate2 { effect tB2B3=time+24, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tB2B3) && (cycle==0) && (v9==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B2==undef1); effect B2=cempty; },
 two1 -> two2 { guard (B2==undef2); effect B2=water28C; },
 two1 -> two2 { },
 two2 -> two3 { guard (B3==undef1); effect B3=water28C; },
 two2 -> two3 { guard ((B3==undef2) && (mix==1)); effect B3=sol70C; },
 two2 -> two2 { guard ((B3!=undef1) && ((B3!=undef2) || (not(mix==1)))); 
	effect error=4; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process B3toB4 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B3==sol70C) && (v11==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B4!=sol140C); effect B3=undef1; },
 one1 -> one1 { guard (B4==sol140C); effect error=5; },
 one2 -> one3 { guard (B4==cempty); effect B4=undef1; },
 one2 -> one3 { guard (B4==sol70C); effect B4=undef2; },
 one2 -> one2 { guard ((B4!=cempty) && (B4!=sol70C)); effect error=6; },
 one3 -> initstate2 { effect tB3B4=time+7, batches=batches+1, cycle=1, 
	atomic=0; },
 initstate2 -> two1 { guard ((time==tB3B4) && (cycle==0) && (v11==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B4!=sol140C); effect B3=cempty; },
 two1 -> two1 { guard (B4==sol140C); effect error=7; },
 two2 -> two3 { guard (B4==undef1); effect B4=sol70C; },
 two2 -> two3 { guard (B4==undef2); effect B4=sol140C; },
 two2 -> two2 { guard ((B4!=undef1) && (B4!=undef2)); effect error=8; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process B4toB5 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B4!=cempty) && (v12==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B5==cempty); effect B5=undef1; },
 one1 -> one1 { guard (B5!=cempty); effect error=9; },
 one2 -> one3 { guard (B4==sol70C); effect B4=undef1; },
 one2 -> one3 { guard (B4==sol140C); effect B4=undef2; },
 one2 -> one3 { },
 one3 -> initstate2 { effect tB4B5=time+35, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tB4B5) && (cycle==0) && (v12==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B5==undef1); effect B5=sol70C; },
 two1 -> two1 { guard (B5!=undef1); effect error=10; },
 two2 -> two3 { guard (B4==undef1); effect B4=cempty; },
 two2 -> two3 { guard (B4==undef2); effect B4=sol70C; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process Heat5 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (heat==1) && (atomic==0)); 
	effect atomic=1; },
 one1 -> one2 { guard (B5==sol70C); effect B5=undef1; },
 one1 -> one1 { guard (B5!=sol70C); effect error=11; },
 one2 -> one3 { guard ((v13==1) && (B6==cempty)); effect B6=undef1; },
 one2 -> one3 { guard ((v13==1) && (B6==water28H)); effect B6=undef2; },
 one2 -> one3 { guard ((v13==1) && (B6==water28C)); effect B6=undef2; },
 one2 -> one2 { guard ((v13==1) && (B6!=cempty) && (B6!=water28H) && 
	(B6==water28C)); effect error=12; },
 one2 -> one3 { guard (not(v13==1)); },
 one3 -> initstate2 { effect tH=time+110, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tH) && (cycle==0) && (heat==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B5==undef1); effect B5=sol42H; },
 two1 -> two1 { guard (B5!=undef1); effect error=13; },
 two2 -> two3 { guard ((v13==1) && (B6==undef1)); effect B6=water28H; },
 two2 -> two3 { guard ((v13==1) && (B6==undef2)); effect B6=water56H; },
 two2 -> two2 { guard ((v13==1) && (B6!=undef1) && (B6!=undef2)); 
	effect error=14; },
 two2 -> two3 { guard (not(v13==1)); },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process B5toB7 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B5!=cempty) && (v15==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B5==sol42H); effect B5=undef1; },
 one1 -> one1 { guard (B5!=sol42H); effect error=15; },
 one2 -> one3 { guard (B7==cempty); effect B7=undef1; },
 one2 -> one3 { guard ((B7==sol42H) || (B7==sol42C)); effect B7=undef2; },
 one2 -> one2 { guard ((B7!=cempty) && (B7!=sol42H) && (B7==sol42C)); 
	effect error=16; },
 one3 -> initstate2 { effect tB5B7=time+28, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tB5B7) && (cycle==0) && (v15==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B5==undef1); effect B5=cempty; },
 two1 -> two1 { guard (B5!=undef1); effect error=17; },
 two2 -> two3 { guard (B7==undef1); effect B7=sol42H; },
 two2 -> two3 { guard (B7==undef2); effect B7=sol84H; },
 two2 -> two2 { guard ((B7!=undef1) && (B7!=undef2)); effect error=18; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process Cool6 {
state initstate, initstate2, one1, one2, two1, two2;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (v29==1) && (atomic==0)); 
	effect atomic=1; },
 one1 -> one2 { guard (B6==water28H); effect B6=undef1, tC6=time+30; },
 one1 -> one2 { guard (B6==water56H); effect B6=undef2, tC6=time+60; },
 one1 -> one1 { guard ((B6!=water28H) && (B6!=water56H)); effect error=19; },
 one2 -> initstate2 { effect cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tC6) && (cycle==0) && (v29==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B6==undef1); effect B6=water28C; },
 two1 -> two2 { guard (B6==undef2); effect B6=water56C; },
 two1 -> two1 { guard ((B6!=undef1) && (B6!=undef2)); effect error=20; },
 two2 -> initstate { effect cycle=1, atomic=0; };
}

process Cool7 {
state initstate, initstate2, one1, one2, two1, two2;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (v17==1) && (atomic==0)); 
	effect atomic=1; },
 one1 -> one2 { guard (B7==sol42H); effect B7=undef1, tC7=time+60; },
 one1 -> one2 { guard (B7==sol84H); effect B7=undef2, tC7=time+120; },
 one1 -> one1 { guard ((B7!=sol42H) && (B7!=sol84H)); effect error=21; },
 one2 -> initstate2 { effect cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tC7) && (cycle==0) && (v17==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B7==undef1); effect B7=sol42C; },
 two1 -> two2 { guard (B7==undef2); effect B7=sol84C; },
 two1 -> two1 { guard ((B7!=undef1) && (B7!=undef2)); effect error=22; },
 two2 -> initstate { effect cycle=1, atomic=0; };
}

process Pump1 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B7!=cempty) && (p1==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B7==sol42C); effect B7=undef1; },
 one1 -> one2 { guard (B7==sol84C); effect B7=undef2; },
 one1 -> one1 { guard ((B7!=sol42C) && (B7!=sol84C)); effect error=23; },
 one2 -> one3 { guard (B1==cempty); effect B1=undef1; },
 one2 -> one3 { guard (B1==sol42C); effect B1=undef2; },
 one2 -> one2 { guard ((B1!=cempty) && (B1!=sol42C)); effect error=24; },
 one3 -> initstate2 { effect tP1=time+22, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tP1) && (cycle==0) && (p1==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B7==undef1); effect B7=cempty; },
 two1 -> two2 { guard (B7==undef2); effect B7=sol42C; },
 two1 -> two1 { guard ((B7!=undef1) && (B7!=undef2)); effect error=25; },
 two2 -> two3 { guard (B1==undef1); effect B1=sol42C; },
 two2 -> two3 { guard (B1==undef2); effect B1=sol84C; },
 two2 -> two2 { guard ((B1!=undef1) && (B1!=undef2)); effect error=26; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process Pump2 {
state initstate, initstate2, one1, one2, one3, two1, two2, two3;
init initstate;
trans
 initstate -> one1 { guard ((cycle==0) && (B6!=cempty) && (p2==1) && 
	(atomic==0)); effect atomic=1; },
 one1 -> one2 { guard (B6==water28C); effect B6=undef1; },
 one1 -> one2 { guard (B6==water56C); effect B6=undef2; },
 one1 -> one1 { guard ((B6!=water28C) && (B6!=water56C)); effect error=27; },
 one2 -> one3 { guard (B2==cempty); effect B2=undef1; },
 one2 -> one3 { guard (B2==water28C); effect B2=undef2; },
 one2 -> one2 { guard ((B2!=cempty) && (B2!=water28C)); effect error=28; },
 one3 -> initstate2 { effect tP2=time+24, cycle=1, atomic=0; },
 initstate2 -> two1 { guard ((time==tP2) && (cycle==0) && (p2==1) && 
	(atomic==0)); effect atomic=1; },
 two1 -> two2 { guard (B6==undef1); effect B6=cempty; },
 two1 -> two2 { guard (B6==undef2); effect B6=water28C; },
 two1 -> two1 { guard ((B6!=undef1) && (B6!=undef2)); effect error=29; },
 two2 -> two3 { guard (B2==undef1); effect B2=water28C; },
 two2 -> two3 { guard (B2==undef2); effect B2=water56C; },
 two2 -> two2 { guard ((B2!=undef1) && (B2!=undef2)); effect error=30; },
 two3 -> initstate { effect cycle=1, atomic=0; };
}

process Control {
int i, j, last;
state initstate, end, one1, one2, one3, one4, two1, two2, two3, three;
init initstate;
trans
 initstate -> one1 { guard ((time<maxtime) && (atomic==0)); effect atomic=1, 
	i=1, j=1; },
 one1 -> one2 { guard (i<15); },
 one2 -> one3 { guard ((result(i,j)) && ((i<12)&&(px[i]==1))); },
 one2 -> one3 { guard ((result(i,j)) && ((i==12)&&(px[11]==1))); },
 one2 -> one3 { guard ((result(i,j)) && ((i>12)&&(px[12]==1))); },
 one3 -> one4 { guard (i==1); effect px[1]=0, v8=0; },
 one3 -> one4 { guard (i==2); effect px[2]=0, v9=0; },
 one3 -> one4 { guard (i==3); effect px[3]=0, v8=0, mix=0; },
 one3 -> one4 { guard (i==4); effect px[4]=0, v9=0, mix=0; },
 one3 -> one4 { guard (i==5); effect px[5]=0, v11=0; },
 one3 -> one4 { guard (i==6); effect px[6]=0, v12=0; },
 one3 -> one4 { guard (i==7); effect px[7]=0, heat=0, v13=0; },
 one3 -> one4 { guard (i==8); effect px[8]=0, v15=0; },
 one3 -> one4 { guard (i==9); effect px[9]=0, v17=0; },
 one3 -> one4 { guard (i==10); effect px[10]=0, v29=0; },
 one3 -> one4 { guard ((i==11) || (i==12)); effect px[11]=0, p1=0; },
 one3 -> one4 { guard ((i==13) || (i==14)); effect px[12]=0, p2=0; },
 one2 -> one4 { guard ((not(result(i,j))) || ((i<12)&&(px[i]==0))); },
 one2 -> one4 { guard ((not(result(i,j))) || ((i==12)&&(px[11]==0))); },
 one2 -> one4 { guard ((not(result(i,j))) || ((i>12)&&(px[12]==0))); },
 one4 -> one1 { guard (j==1); effect j=2; },
 one4 -> one1 { guard (j==2); effect j=1, i=i+1; },
 one1 -> two1 { guard (i==15); effect i=1, j=1, last=1; },
 two1 -> two2 { guard (i<15); },
 
 two2 -> two3 { guard ((i==1) && (theta(i,j)) && (px[1]==0)); effect px[1]=1, 
	v8=1; },
 two2 -> two3 { guard ((i==2) && (theta(i,j)) && (px[2]==0)); effect px[2]=1, 
	v9=1; },
 two2 -> two3 { guard ((i==3) && (theta(i,j)) && (px[3]==0)); effect px[3]=1, 
	v8=1, mix=1; },
 two2 -> two3 { guard ((i==4) && (theta(i,j)) && (px[4]==0)); effect px[4]=1, 
	v9=1, mix=1; },
 two2 -> two3 { guard ((i==5) && (theta(i,j)) && (px[5]==0)); effect px[5]=1, 
	v11=1; },
 two2 -> two3 { guard ((i==6) && (theta(i,j)) && (px[6]==0)); effect px[6]=1, 
	v12=1; },
 two2 -> two3 { guard ((i==7) && (theta(i,j)) && (px[7]==0)); effect px[7]=1, 
	v13=1, heat=1; },
 two2 -> two3 { guard ((i==8) && (theta(i,j)) && (px[8]==0)); effect px[8]=1, 
	v15=1; },
 two2 -> two3 { guard ((i==9) && (theta(i,j)) && (px[9]==0)); effect px[9]=1, 
	v17=1; },
 two2 -> two3 { guard ((i==10) && (theta(i,j)) && (px[10]==0)); 
	effect px[10]=1, v29=1; },
 two2 -> two3 { guard ((i==11) && (theta(i,j)) && (px[11]==0)); 
	effect px[11]=1, p1=1; },
 two2 -> two3 { guard ((i==12) && (theta(i,j)) && (px[11]==0)); 
	effect px[11]=1, p1=1; },
 two2 -> two3 { guard ((i==13) && (theta(i,j)) && (px[12]==0)); 
	effect px[12]=1, p2=1; },
 two2 -> two3 { guard ((i==14) && (theta(i,j)) && (px[12]==0)); 
	effect px[12]=1, p2=1; },
 two2 -> two3 { guard ((theta(i,j)) && ((i<12)&&(px[i]==0))); effect last=i; },
 two2 -> two3 { guard ((theta(i,j)) && ((i==12)&&(px[11]==0))); 
	effect last=i; },
 two2 -> two3 { guard ((theta(i,j)) && ((i>12)&&(px[12]==0))); effect last=i; },
 two2 -> two3 { guard ((not(theta(i,j))) || ((i<12)&&(px[i]==1))); },
 two2 -> two3 { guard ((not(theta(i,j))) || ((i==12)&&(px[11]==1))); },
 two2 -> two3 { guard ((not(theta(i,j))) || ((i>12)&&(px[12]==1))); },
 two3 -> two1 { guard (j==1); effect j=2; },
 two3 -> two1 { guard (j==2); effect j=1, i=i+1; },
 two1 -> three { guard (i==15); },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==1)); 
	effect cycle=0, px[1]=1, v8=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==2)); 
	effect cycle=0, px[2]=1, v9=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==3)); 
	effect cycle=0, px[3]=1, v8=1, mix=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==4));
	effect cycle=0, px[4]=1, v9=1, mix=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==5)); 
	effect cycle=0, px[5]=1, v11=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==6)); 
	effect cycle=0, px[6]=1, v12=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==7)); 
	effect cycle=0, px[7]=1, v13=1, heat=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==8)); 
	effect cycle=0, px[8]=1, v15=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==9)); 
	effect cycle=0, px[9]=1, v17=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==10)); 
	effect cycle=0, px[10]=1, v29=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==11)); 
	effect cycle=0, px[11]=1, p1=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==12)); 
	effect cycle=0, px[11]=1, p1=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==13));
	effect cycle=0, px[12]=1, p2=1, atomic=0; },
 three -> initstate { guard ((px[1]==0) && (px[2]==0) && (px[3]==0) && 
	(px[4]==0) && (px[5]==0) && (px[6]==0) && (px[7]==0) && (px[8]==0) && 
	(px[9]==0) && (px[10]==0) && (px[11]==0) && (px[12]==0) && (last==14)); 
	effect cycle=0, px[12]=1, p2=1, atomic=0; },
 three -> initstate { guard ((px[1]==1) || (px[2]==1) || (px[3]==1) || 
	(px[4]==1) || (px[5]==1) || (px[6]==1) || (px[7]==1) || (px[8]==1) || 
	(px[9]==1) || (px[10]==1) || (px[11]==1) || (px[12]==1)); 
	effect cycle=0, atomic=0; },
 initstate -> end { guard (time>=maxtime); },
 end -> end { };
}

process Advance {
int i, minstep;
state initstate, one1;
init initstate;
trans
 initstate -> one1 { guard ((atomic==0) && ((((px[1]==1) || (px[2]==1) || 
	(px[3]==1) || (px[4]==1) || (px[5]==1) || (px[6]==1) || (px[7]==1) || 
	(px[8]==1) || (px[9]==1) || (px[10]==1) || (px[11]==1) || (px[12]==1)) 
	&& ((px[1]==0) || ((B1<2) && (B3<2) && (tB1B3>time))) &&
           ((px[2]==0) || ((B2<2) && (B3<2) && (tB2B3>time))) &&
           ((px[3]==0) || ((B1<2) && (B3<2) && (tB1B3>time))) &&
           ((px[4]==0) || ((B2<2) && (B3<2) && (tB2B3>time))) &&
           ((px[5]==0) || ((B3<2) && (B4<2) && (tB3B4>time))) &&
           ((px[6]==0) || ((B4<2) && (B5<2) && (tB4B5>time))) &&
           ((px[7]==0) || ((B5<2) && (B6<2) && (tH>time))) &&
           ((px[8]==0) || ((B5<2) && (B7<2) && (tB5B7>time))) &&
           ((px[9]==0) || ((B7<2) && (v17==1) && (tC7>time))) &&
           ((px[10]==0) || ((B6<2) && (v29==1) && (tC6>time))) &&
           ((px[11]==0) || ((B7<2) && (B1<2) && (tP1>time))) &&
           ((px[12]==0) || ((B6<2) && (B2<2) && (tP2>time))))));
	effect atomic=1, minstep=maxstep, i=1; },
 one1 -> one1 { guard ((i==1) && (px[1]==1) && ((tB1B3-time)<minstep)); 
	effect minstep=(tB1B3-time), i=2; },
 one1 -> one1 { guard ((i==2) && (px[2]==1) && ((tB2B3-time)<minstep)); 
	effect minstep=(tB2B3-time), i=3; },
 one1 -> one1 { guard ((i==3) && (px[3]==1) && ((tB1B3-time)<minstep)); 
	effect minstep=(tB1B3-time), i=4; },
 one1 -> one1 { guard ((i==4) && (px[4]==1) && ((tB2B3-time)<minstep)); 
	effect minstep=(tB2B3-time), i=5; },
 one1 -> one1 { guard ((i==5) && (px[5]==1) && ((tB3B4-time)<minstep)); 
	effect minstep=(tB3B4-time), i=6; },
 one1 -> one1 { guard ((i==6) && (px[6]==1) && ((tB4B5-time)<minstep)); 
	effect minstep=(tB4B5-time), i=7; },
 one1 -> one1 { guard ((i==7) && (px[7]==1) && ((tH-time)<minstep)); 
	effect minstep=(tH-time), i=8; },
 one1 -> one1 { guard ((i==8) && (px[8]==1) && ((tB5B7-time)<minstep)); 
	effect minstep=(tB5B7-time), i=9; },
 one1 -> one1 { guard ((i==9) && (px[9]==1) && ((tC7-time)<minstep)); 
	effect minstep=(tC7-time), i=10; },
 one1 -> one1 { guard ((i==10) && (px[10]==1) && ((tC6-time)<minstep)); 
	effect minstep=(tC6-time), i=11; },
 one1 -> one1 { guard ((i==11) && (px[11]==1) && ((tP1-time)<minstep)); 
	effect minstep=(tP1-time), i=12; },
 one1 -> one1 { guard ((i==12) && (px[12]==1) && ((tP2-time)<minstep)); 
	effect minstep=(tP2-time), i=13; },
 one1 -> one1 { guard ((i==1) && ((px[1]==0) || ((tB1B3-time)>=minstep))); 
	effect i=2; },
 one1 -> one1 { guard ((i==2) && ((px[2]==0) || ((tB2B3-time)>=minstep))); 
	effect i=3; },
 one1 -> one1 { guard ((i==3) && ((px[3]==0) || ((tB1B3-time)>=minstep))); 
	effect i=4; },
 one1 -> one1 { guard ((i==4) && ((px[4]==0) || ((tB2B3-time)>=minstep))); 
	effect i=5; },
 one1 -> one1 { guard ((i==5) && ((px[5]==0) || ((tB3B4-time)>=minstep))); 
	effect i=6; },
 one1 -> one1 { guard ((i==6) && ((px[6]==0) || ((tB4B5-time)>=minstep))); 
	effect i=7; },
 one1 -> one1 { guard ((i==7) && ((px[7]==0) || ((tH-time)>=minstep))); 
	effect i=8; },
 one1 -> one1 { guard ((i==8) && ((px[8]==0) || ((tB5B7-time)>=minstep))); 
	effect i=9; },
 one1 -> one1 { guard ((i==9) && ((px[9]==0) || ((tC7-time)>=minstep))); 
	effect i=10; },
 one1 -> one1 { guard ((i==10) && ((px[10]==0) || ((tC6-time)>=minstep))); 
	effect i=11; },
 one1 -> one1 { guard ((i==11) && ((px[11]==0) || ((tP1-time)>=minstep))); 
	effect i=12; },
 one1 -> one1 { guard ((i==12) && ((px[12]==0) || ((tP2-time)>=minstep))); 
	effect i=13; },
 one1 -> initstate { guard (i==13); effect time=time+minstep, atomic=0; }; 
}

system async;
